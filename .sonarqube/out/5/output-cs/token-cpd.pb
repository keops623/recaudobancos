«[
lC:\julian\Source\Repos\CC00-RecaudosServicioBanco-NetCore\Corona.RecaudoPagos.Soporte\General\Criptografo.cs
	namespace 	
Corona
 
. 
RecaudoPagos 
. 
Soporte %
.% &
General& -
{ 
public 

class 
Criptografo 
{ 
public 
static 
string 
MD5  
(  !
string! '
word( ,
), -
{ 	
try 
{ 
MD5 
md5 
= $
MD5CryptoServiceProvider 2
.2 3
Create3 9
(9 :
): ;
;; <
ASCIIEncoding 
encoding &
=' (
new) ,
ASCIIEncoding- :
(: ;
); <
;< =
byte 
[ 
] 
stream 
= 
null  $
;$ %
StringBuilder 
sb  
=! "
new# &
StringBuilder' 4
(4 5
)5 6
;6 7
stream 
= 
md5 
. 
ComputeHash (
(( )
encoding) 1
.1 2
GetBytes2 :
(: ;
word; ?
)? @
)@ A
;A B
for 
( 
int 
i 
= 
$num 
; 
i  !
<" #
stream$ *
.* +
Length+ 1
;1 2
i3 4
++4 6
)6 7
sb8 :
.: ;
AppendFormat; G
(G H
$strH P
,P Q
streamR X
[X Y
iY Z
]Z [
)[ \
;\ ]
return 
sb 
. 
ToString "
(" #
)# $
;$ %
} 
catch 
{ 
return 
word 
;  
}! "
} 	
public   
static   
string   
Token   "
(  " #
)  # $
{!! 	
long"" 
i"" 
="" 
$num"" 
;"" 
foreach## 
(## 
byte## 
b## 
in## 
Guid## #
.### $
NewGuid##$ +
(##+ ,
)##, -
.##- .
ToByteArray##. 9
(##9 :
)##: ;
)##; <
i##= >
*=##? A
(##B C
(##C D
int##D G
)##G H
b##H I
+##J K
$num##L M
)##M N
;##N O
return$$ 
MD5$$ 
($$ 
string$$ 
.$$ 
Format$$ $
($$$ %
$str$$% ,
,$$, -
i$$. /
-$$0 1
DateTime$$2 :
.$$: ;
Now$$; >
.$$> ?
Ticks$$? D
)$$D E
)$$E F
;$$F G
}%% 	
public++ 
string++ 
Base64Encode++ "
(++" #
string++# )
word++* .
)++. /
{,, 	
try-- 
{.. 
byte// 
[// 
]// 
byt// 
=// 
System// #
.//# $
Text//$ (
.//( )
Encoding//) 1
.//1 2
UTF8//2 6
.//6 7
GetBytes//7 ?
(//? @
word//@ D
)//D E
;//E F
return00 
Convert00 
.00 
ToBase64String00 -
(00- .
byt00. 1
)001 2
;002 3
}11 
catch22 
{22 
return22 
word22 
;22  
}22! "
}33 	
public99 
string99 
Base64Decode99 "
(99" #
string99# )
word99* .
)99. /
{:: 	
try;; 
{<< 
byte== 
[== 
]== 
b== 
=== 
Convert== "
.==" #
FromBase64String==# 3
(==3 4
word==4 8
)==8 9
;==9 :
return>> 
System>> 
.>> 
Text>> "
.>>" #
Encoding>># +
.>>+ ,
UTF8>>, 0
.>>0 1
	GetString>>1 :
(>>: ;
b>>; <
)>>< =
;>>= >
}?? 
catch@@ 
{@@ 
return@@ 
word@@ 
;@@  
}@@! "
}AA 	
publicGG 
staticGG 
stringGG 
SHA1GG !
(GG! "
stringGG" (
strGG) ,
)GG, -
{HH 	
tryII 
{JJ 
SHA1KK 
sha1KK 
=KK 
SHA1ManagedKK '
.KK' (
CreateKK( .
(KK. /
)KK/ 0
;KK0 1
ASCIIEncodingLL 
encodingLL &
=LL' (
newLL) ,
ASCIIEncodingLL- :
(LL: ;
)LL; <
;LL< =
byteMM 
[MM 
]MM 
streamMM 
=MM 
nullMM  $
;MM$ %
StringBuilderNN 
sbNN  
=NN! "
newNN# &
StringBuilderNN' 4
(NN4 5
)NN5 6
;NN6 7
streamOO 
=OO 
sha1OO 
.OO 
ComputeHashOO )
(OO) *
encodingOO* 2
.OO2 3
GetBytesOO3 ;
(OO; <
strOO< ?
)OO? @
)OO@ A
;OOA B
forPP 
(PP 
intPP 
iPP 
=PP 
$numPP 
;PP 
iPP  !
<PP" #
streamPP$ *
.PP* +
LengthPP+ 1
;PP1 2
iPP3 4
++PP4 6
)PP6 7
sbPP8 :
.PP: ;
AppendFormatPP; G
(PPG H
$strPPH P
,PPP Q
streamPPR X
[PPX Y
iPPY Z
]PPZ [
)PP[ \
;PP\ ]
returnQQ 
sbQQ 
.QQ 
ToStringQQ "
(QQ" #
)QQ# $
;QQ$ %
}RR 
catchSS 
{SS 
returnSS 
strSS 
;SS 
}SS  !
}TT 	
publicZZ 
staticZZ 
stringZZ 
SHA256ZZ #
(ZZ# $
stringZZ$ *
strZZ+ .
)ZZ. /
{[[ 	
try\\ 
{]] 
SHA256^^ 
sha256^^ 
=^^ 
SHA256Managed^^  -
.^^- .
Create^^. 4
(^^4 5
)^^5 6
;^^6 7
ASCIIEncoding__ 
encoding__ &
=__' (
new__) ,
ASCIIEncoding__- :
(__: ;
)__; <
;__< =
byte`` 
[`` 
]`` 
stream`` 
=`` 
null``  $
;``$ %
StringBuilderaa 
sbaa  
=aa! "
newaa# &
StringBuilderaa' 4
(aa4 5
)aa5 6
;aa6 7
streambb 
=bb 
sha256bb 
.bb  
ComputeHashbb  +
(bb+ ,
encodingbb, 4
.bb4 5
GetBytesbb5 =
(bb= >
strbb> A
)bbA B
)bbB C
;bbC D
forcc 
(cc 
intcc 
icc 
=cc 
$numcc 
;cc 
icc  !
<cc" #
streamcc$ *
.cc* +
Lengthcc+ 1
;cc1 2
icc3 4
++cc4 6
)cc6 7
sbcc8 :
.cc: ;
AppendFormatcc; G
(ccG H
$strccH P
,ccP Q
streamccR X
[ccX Y
iccY Z
]ccZ [
)cc[ \
;cc\ ]
returndd 
sbdd 
.dd 
ToStringdd "
(dd" #
)dd# $
;dd$ %
}ee 
catchff 
{ff 
returnff 
strff 
;ff 
}ff  !
}gg 	
publicmm 
staticmm 
stringmm 
SHA384mm #
(mm# $
stringmm$ *
strmm+ .
)mm. /
{nn 	
tryoo 
{pp 
SHA384qq 
sha384qq 
=qq 
SHA384Managedqq  -
.qq- .
Createqq. 4
(qq4 5
)qq5 6
;qq6 7
ASCIIEncodingrr 
encodingrr &
=rr' (
newrr) ,
ASCIIEncodingrr- :
(rr: ;
)rr; <
;rr< =
bytess 
[ss 
]ss 
streamss 
=ss 
nullss  $
;ss$ %
StringBuildertt 
sbtt  
=tt! "
newtt# &
StringBuildertt' 4
(tt4 5
)tt5 6
;tt6 7
streamuu 
=uu 
sha384uu 
.uu  
ComputeHashuu  +
(uu+ ,
encodinguu, 4
.uu4 5
GetBytesuu5 =
(uu= >
struu> A
)uuA B
)uuB C
;uuC D
forvv 
(vv 
intvv 
ivv 
=vv 
$numvv 
;vv 
ivv  !
<vv" #
streamvv$ *
.vv* +
Lengthvv+ 1
;vv1 2
ivv3 4
++vv4 6
)vv6 7
sbvv8 :
.vv: ;
AppendFormatvv; G
(vvG H
$strvvH P
,vvP Q
streamvvR X
[vvX Y
ivvY Z
]vvZ [
)vv[ \
;vv\ ]
returnww 
sbww 
.ww 
ToStringww "
(ww" #
)ww# $
;ww$ %
}xx 
catchyy 
{yy 
returnyy 
stryy 
;yy 
}yy  !
}zz 	
public
€€ 
static
€€ 
string
€€ 
SHA512
€€ #
(
€€# $
string
€€$ *
str
€€+ .
)
€€. /
{
 	
try
‚‚ 
{
ƒƒ 
SHA512
„„ 
sha512
„„ 
=
„„ 
SHA512Managed
„„  -
.
„„- .
Create
„„. 4
(
„„4 5
)
„„5 6
;
„„6 7
ASCIIEncoding
…… 
encoding
…… &
=
……' (
new
……) ,
ASCIIEncoding
……- :
(
……: ;
)
……; <
;
……< =
byte
†† 
[
†† 
]
†† 
stream
†† 
=
†† 
null
††  $
;
††$ %
StringBuilder
‡‡ 
sb
‡‡  
=
‡‡! "
new
‡‡# &
StringBuilder
‡‡' 4
(
‡‡4 5
)
‡‡5 6
;
‡‡6 7
stream
ˆˆ 
=
ˆˆ 
sha512
ˆˆ 
.
ˆˆ  
ComputeHash
ˆˆ  +
(
ˆˆ+ ,
encoding
ˆˆ, 4
.
ˆˆ4 5
GetBytes
ˆˆ5 =
(
ˆˆ= >
str
ˆˆ> A
)
ˆˆA B
)
ˆˆB C
;
ˆˆC D
for
‰‰ 
(
‰‰ 
int
‰‰ 
i
‰‰ 
=
‰‰ 
$num
‰‰ 
;
‰‰ 
i
‰‰  !
<
‰‰" #
stream
‰‰$ *
.
‰‰* +
Length
‰‰+ 1
;
‰‰1 2
i
‰‰3 4
++
‰‰4 6
)
‰‰6 7
sb
‰‰8 :
.
‰‰: ;
AppendFormat
‰‰; G
(
‰‰G H
$str
‰‰H P
,
‰‰P Q
stream
‰‰R X
[
‰‰X Y
i
‰‰Y Z
]
‰‰Z [
)
‰‰[ \
;
‰‰\ ]
return
ŠŠ 
sb
ŠŠ 
.
ŠŠ 
ToString
ŠŠ "
(
ŠŠ" #
)
ŠŠ# $
;
ŠŠ$ %
}
‹‹ 
catch
ŒŒ 
{
ŒŒ 
return
ŒŒ 
str
ŒŒ 
;
ŒŒ 
}
ŒŒ  !
}
 	
}
ŽŽ 
} 